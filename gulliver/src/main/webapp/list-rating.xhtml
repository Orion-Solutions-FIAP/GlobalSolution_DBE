<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html 	xmlns="http://www.w3.org/1999/xhtml"
		xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
		xmlns:h="http://xmlns.jcp.org/jsf/html"
		xmlns:f="http://xmlns.jcp.org/jsf/core"
		xmlns:p="http://primefaces.org/ui">

<ui:composition template="_template.xhtml">

	<ui:define name="content">
		
		<div class="listSection" >
			<div class="card">
			    <h:form id="form">
			        <p:dataTable id="data" var="rating" value="#{ratingBean.userRating}">
			            <f:facet name="header">
			                Avaliações
			            </f:facet>
			            
			            <p:column style="width:2rem">
	                		<p:rowToggler/>
	            		</p:column>
			
			            <p:column headerText="Locadora">
			                <h:outputText value="#{rating.rentalCompany.name}"/>
			            </p:column>
			
			            <p:column headerText="Titulo">
			                <h:outputText value="#{rating.title}"/>
			            </p:column>
			
			            <p:column styleClass="avaliacao" headerText="Avaliacao">
			                <p:rating readonly="true" value="#{rating.grade}"/>
			            </p:column>
			            
			            <p:column styleClass="botoes">
			                <p:commandButton icon="pi pi-pencil" styleClass="rounded-button" update="manage-product-content:panel" process="@this" oncomplete="PF('ratingUser').show()">
			                	<f:ajax execute="@form" render="form-users"/>
			                	<f:setPropertyActionListener value="#{rating}" target="#{ratingBean.ratingEdit}"/>
			                </p:commandButton>
			                <p:button icon="pi pi-times" styleClass="rounded-button ui-button-danger" />
			            </p:column>
			            
			             <p:rowExpansion>
			                <div class="product">
			                    <div class="product-list-item">
			                    	<p:graphicImage url="#{rating.rentalCompany.urlImage}" width="100"/>
			                    	
			                        <div class="product-list-detail">
			                            <div class="product-name">#{rating.title}</div>
			                            <div class="product-description">#{rating.description}</div>
		                           	</div>
		                           	    
		                          	<p:rating readonly="true" value="#{rating.grade}"/>
			                            
			                    </div>
			                </div>
			            </p:rowExpansion>
			            
			            
			        </p:dataTable>
		     	</h:form>
			</div>
		</div>   
          <p:dialog header="Edit Avaliação" height="500" width="500" modal="true"
                 widgetVar="ratingUser" responsive="true">
           <h:form id="manage-product-content">
			<p:card class="card-form">
				
				 <p:outputPanel id="panel" class="ui-fluid">
					<h:panelGrid columns="2">
	              
		                <p:outputLabel value="Titulo" for="title" />
						<p:inputText id="title" value="#{ratingBean.rating.title}" required="true" requiredMessage="Erro de validação"/>
						
						<p:outputLabel value="Descrição" for="description"/>
						<p:inputTextarea value="#{ratingBean.rating.description}" id="description" rows="6" cols="30"/>
						
						<p:outputLabel value="Nota" for="grade"/>
						<p:rating id="grade" value="#{ratingBean.rating.grade}"/>
					
					</h:panelGrid>
				</p:outputPanel>
			
	
	            <f:facet name="footer">
	                <p:commandButton value="Edit" icon="pi pi-check" actionListener="#{ratingBean.editRating}" onclick="PF('modal').hide();$('#form').trigger('reset');"/>
	                <p:commandButton value="Cancel" icon="pi pi-times" onclick="PF('ratingUser').hide()"
	                                 class="ui-button-secondary"/>
	            </f:facet>
            </p:card>
		</h:form>
       </p:dialog>
			        
	</ui:define>

</ui:composition>
</html>